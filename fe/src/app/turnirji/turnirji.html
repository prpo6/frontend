<div class="turnirji-container">
  <div class="header-with-home">
    <h1>Upravljanje Turnirjev</h1>
    <button class="btn-home" (click)="navigateToHome()">ğŸ  Domov</button>
  </div>

  <button (click)="toggleAddForm()" class="add-btn">
    {{ showAddForm ? 'PrekliÄi' : '+ Dodaj Turnir' }}
  </button>

  <!-- Add/Edit Form -->
  <div *ngIf="showAddForm" class="turnir-form">
    <h2>{{ editMode ? 'Uredi Turnir' : 'Dodaj Nov Turnir' }}</h2>
    
    <div class="form-group">
      <label>Naziv turnirja*:</label>
      <input type="text" [(ngModel)]="newTurnir.naziv" placeholder="Npr. Poletni turnir 2026">
    </div>

    <div class="form-group">
      <label>Opis:</label>
      <textarea [(ngModel)]="newTurnir.opis" rows="3" placeholder="Opis turnirja"></textarea>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Datum zaÄetka*:</label>
        <input type="date" [(ngModel)]="newTurnir.datumZacetek">
      </div>

      <div class="form-group">
        <label>Datum konca:</label>
        <input type="date" [(ngModel)]="newTurnir.datumKonec">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Tip turnirja*:</label>
        <select [(ngModel)]="newTurnir.tipTurnirja">
          <option value="leaderboard">Lestvica (Stroke Play)</option>
          <option value="bracket">IzloÄilni (Match Play)</option>
        </select>
      </div>

      <div class="form-group">
        <label>Maksimalno igralcev*:</label>
        <input type="number" [(ngModel)]="newTurnir.maxIgralcev" min="2" max="128">
      </div>
    </div>

    <div class="form-group">
      <label>Å tevilo rund:</label>
      <input type="number" [(ngModel)]="newTurnir.steviloRund" min="1">
    </div>

    <div class="form-actions">
      <button *ngIf="!editMode" (click)="addTurnir()" class="save-btn">Ustvari Turnir</button>
      <button *ngIf="editMode" (click)="saveEdit()" class="save-btn">Shrani Spremembe</button>
      <button (click)="toggleAddForm()" class="cancel-btn">PrekliÄi</button>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <p>Nalaganje turnirjev...</p>
  </div>

  <!-- Turnirji List -->
  <div *ngIf="!loading" class="turnirji-grid">
    <div *ngFor="let turnir of turnirji" class="turnir-card">
      <div class="turnir-header">
        <h3>{{ turnir.naziv }}</h3>
        <span [class]="'status-badge ' + getStatusClass(turnir.status)">
          {{ getStatusLabel(turnir.status) }}
        </span>
      </div>

      <p class="turnir-opis" *ngIf="turnir.opis">{{ turnir.opis }}</p>

      <div class="turnir-details">
        <div class="detail-row">
          <strong>Tip:</strong> {{ getTipLabel(turnir.tipTurnirja) }}
        </div>
        <div class="detail-row">
          <strong>Datum:</strong> {{ turnir.datumZacetek }}
          <span *ngIf="turnir.datumKonec"> - {{ turnir.datumKonec }}</span>
        </div>
        <div class="detail-row">
          <strong>Igralci:</strong> {{ turnir.trenutnoIgralcev || 0 }} / {{ turnir.maxIgralcev }}
        </div>
        <div class="detail-row">
          <strong>Å tevilo rund:</strong> {{ turnir.steviloRund }}
        </div>
      </div>

      <div class="turnir-actions">
        <!-- Status-dependent actions -->
        <button *ngIf="turnir.status === 'pending'" 
                (click)="openRegistration(turnir.id!)" 
                class="action-btn open-btn">
          Odpri Prijave
        </button>

        <button *ngIf="turnir.status === 'registration'" 
                (click)="startTurnir(turnir.id!)" 
                class="action-btn start-btn">
          ZaÄni Turnir
        </button>

        <button *ngIf="turnir.status === 'active'" 
                (click)="completeTurnir(turnir.id!)" 
                class="action-btn complete-btn">
          ZakljuÄi
        </button>

        <!-- Always available actions -->
        <button *ngIf="turnir.status !== 'completed'" 
                (click)="editTurnir(turnir)" 
                class="action-btn edit-btn">
          Uredi
        </button>

        <button (click)="deleteTurnir(turnir.id!)" class="action-btn delete-btn">
          IzbriÅ¡i
        </button>
      </div>
    </div>

    <div *ngIf="turnirji.length === 0" class="empty-message">
      <p>Ni Å¡e nobenih turnirjev. Ustvarite prvega!</p>
    </div>
  </div>
</div>
